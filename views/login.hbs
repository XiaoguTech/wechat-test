<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
        <link type="text/css" rel="stylesheet" href="stylesheets/loginStyle.css">
        <script src="javascripts/jquery-3.2.1.min.js"></script>
        <title>登录 | Login</title>
        <style>
            .ui{
                display: none!important;
            }
        </style>
    </head>
    <body>  
        <div class="accountView">
            <div class="loginContainer">
                <div class="loginBox">
                    <div class="loginWrapper">
                        <div class="loginHeader">
                            Broken Arrow
                        </div>
                        <div class="loginContent">
                            <form class="loginForm" name="loginForm" id="loginForm" action="#" method="post">
                                <div class="userField">
                                    <input name="username" type="text" placeholder="组织代码" required="required" id="username"/>
                                </div>
                                <div class="pswField">
                                    <input name="password" type="password" placeholder="Token" required="required" id="password"/>
                                </div>
                                <input type="hidden" value={{openid}} id="openid">
                                <input value="登录" type="submit">
                            </form>
                        </div>
                        <div id="loginTip"></div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            $("#username").focus(function(){
                $("#loginTip").html("");
            });
            $("#password").focus(function(){
                $("#loginTip").html("");
            });
            $('#loginForm').submit(function(){
                var username =$("#username").val();
                var password=$("#password").val();
                var openid=$("#openid").val();
                var data={"username":username,"password":password,"openid":openid};

                $.ajax({
                    url:"/checkLogin",
                    type:"post",
                    data:data,
                    success:function(data,status){
                        if(status=="success"){
                            location.href="/";
                        }
                    },
                    error:function(data,status){
                        if(status=="error"){
                            $("#loginTip").html("用户名或密码错误");
                        }
                    }
                });

                return false;
            });
        </script>
    </body>
</html>